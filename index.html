<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MVOTX-Creator House | Danh sách Host</title>
    <link
      rel="shortcut icon"
      href="./assets/images/icon_header.png"
      type="image/x-icon"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
      rel="stylesheet"
    />
    <style>
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: 'Inter', sans-serif;
        overscroll-behavior: none; /* Prevents scroll bounce for smoother feel */
      }
      .host-card {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.3s ease, transform 0.3s ease;
      }
      .host-card.visible {
        opacity: 1;
        transform: translateY(0);
      }
      img {
        will-change: transform; /* Improves rendering performance */
      }
    </style>
    <link href="./assets/css/list.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Header -->
    <header id="header" class="bg-white shadow-md sticky top-0 z-40">
      <div
        class="container mx-auto px-4 py-3 sm:py-4 flex justify-between items-center"
      >
        <div
          class="flex flex-col items-center animate__animated animate__fadeIn"
        >
          <img
            src="./assets/images/logo.webp"
            alt="MVOTX Logo"
            class="h-8 w-auto sm:h-10"
            loading="lazy"
          />
          <span
            style="color: #6420aa"
            class="text-base sm:text-lg font-bold text-[var(--primary-color)] mt-1"
            >Creator House</span
          >
        </div>
        <div class="flex items-center space-x-2 sm:space-x-3">
          <button
            onclick="copyLink()"
            class="text-gray-600 hover:text-[var(--primary-color)] transition-transform duration-300 hover:scale-110"
          >
            <ion-icon
              name="share-social-outline"
              class="text-xl sm:text-2xl"
            ></ion-icon>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 sm:py-12">
      <!-- Filter Section -->
      <section
        class="filter-section bg-white rounded-3xl shadow-xl p-6 sm:p-8 mb-8 sm:mb-12"
      >
        <h2
          class="section-title text-xl sm:text-2xl font-semibold text-gray-900 mb-6 sm:mb-8"
        >
          Lọc Host
        </h2>
        <div
          class="filter-grid grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6"
        >
          <div>
            <label
              class="block text-sm font-medium text-gray-700 mb-2"
              for="filter-gender"
              >Giới tính</label
            >
            <select
              id="filter-gender"
              class="filter-select w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none"
            >
              <option value="">Tất cả</option>
            </select>
          </div>

          <div>
            <label
              class="block text-sm font-medium text-gray-700 mb-2"
              for="filter-dialect"
              >Giọng vùng miền</label
            >
            <select
              id="filter-dialect"
              class="filter-select w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none"
            >
              <option value="">Tất cả</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2"
              >Năm sinh</label
            >
            <div class="flex items-center gap-4">
              <input
                type="number"
                id="filter-birthYear-from"
                placeholder="Từ"
                class="filter-input w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none"
              />
              <span class="text-gray-600">-</span>
              <input
                type="number"
                id="filter-birthYear-to"
                placeholder="Đến"
                class="filter-input w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none"
              />
            </div>
          </div>
        </div>
      </section>

      <!-- Host List -->
      <section class="mb-8 sm:mb-12">
        <h2
          class="section-title text-xl sm:text-2xl font-semibold text-gray-900 mb-6 sm:mb-8"
        >
          Danh sách Host
        </h2>
        <div
          id="host-list"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8"
        ></div>
      </section>
    </main>

    <footer
      style="
        background: #ffffff;
        border-top: 1px solid rgba(0, 0, 0, 0.05);
        margin-top: 3rem;
        padding: 2rem 0;
      "
    >
      <div style="max-width: 1200px; margin: 0 auto; padding: 0 1rem">
        <div
          style="
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
          "
        >
          <div style="animation: fadeInUp 0.8s ease">
            <h3
              style="
                color: #6420aa;
                font-size: 0.875rem;
                font-weight: 600;
                margin-bottom: 1rem;
              "
            >
              Văn phòng 1
            </h3>
            <p style="font-size: 0.875rem; color: #666666; line-height: 1.5">
              5A Trần Văn Dư, Phường 13<br />Quận Tân Bình, TP. Hồ Chí Minh
            </p>
          </div>
          <div style="animation: fadeInUp 0.8s ease; animation-delay: 0.1s">
            <h3
              style="
                color: #6420aa;
                font-size: 0.875rem;
                font-weight: 600;
                margin-bottom: 1rem;
              "
            >
              Văn phòng 2
            </h3>
            <p style="font-size: 0.875rem; color: #666666; line-height: 1.5">
              391A Nam Kỳ Khởi Nghĩa, Phường 14<br />Quận 3, TP. Hồ Chí Minh
            </p>
          </div>
          <div style="animation: fadeInUp 0.8s ease; animation-delay: 0.2s">
            <h3
              style="
                color: #6420aa;
                font-size: 0.875rem;
                font-weight: 600;
                margin-bottom: 1rem;
              "
            >
              Văn phòng 3
            </h3>
            <p style="font-size: 0.875rem; color: #666666; line-height: 1.5">
              163-165 Trần Trọng Cung<br />Phường Tân Thuận Đông, Quận 7<br />TP.
              Hồ Chí Minh
            </p>
          </div>
          <div style="animation: fadeInUp 0.8s ease; animation-delay: 0.3s">
            <h3
              style="
                color: #6420aa;
                font-size: 0.875rem;
                font-weight: 600;
                margin-bottom: 1rem;
              "
            >
              Văn phòng 4
            </h3>
            <p style="font-size: 0.875rem; color: #666666; line-height: 1.5">
              Dragon Hills, Đường Nguyễn Hữu Thọ<br />Phước Kiển, Nhà Bè<br />TP.
              Hồ Chí Minh
            </p>
            <div style="margin-top: 1rem">
              <p style="font-size: 0.875rem; color: #666666">
                <span style="font-weight: 500">Hotline:</span>
                <a
                  href="tel:1900633336"
                  style="
                    color: #6420aa;
                    text-decoration: none;
                    transition: color 0.2s ease;
                  "
                  onmouseover="this.style.color='#ff5c00'"
                  onmouseout="this.style.color='#6420aa'"
                >
                  1900 633 336
                </a>
              </p>
              <p
                style="font-size: 0.875rem; color: #666666; margin-top: 0.5rem"
              >
                <span style="font-weight: 500">Email:</span>
                <a
                  href="mailto:lienhe@mvotx.com"
                  style="
                    color: #6420aa;
                    text-decoration: none;
                    transition: color 0.2s ease;
                  "
                  onmouseover="this.style.color='#ff5c00'"
                  onmouseout="this.style.color='#6420aa'"
                >
                  lienhe@mvotx.com
                </a>
              </p>
            </div>
          </div>
        </div>
        <div
          style="
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
          "
        >
          <div
            style="
              display: flex;
              flex-direction: column;
              align-items: center;
              gap: 1rem;
              flex-wrap: wrap;
              justify-content: space-between;
            "
          >
            <div
              style="display: flex; gap: 1rem; animation: fadeInUp 0.8s ease"
            >
              <a
                href="#"
                style="
                  color: #666666;
                  transition: transform 0.3s ease, color 0.2s ease;
                "
                onmouseover="this.style.color='#6420aa'; this.style.transform='scale(1.1)'"
                onmouseout="this.style.color='#666666'; this.style.transform='scale(1)'"
              >
                <ion-icon
                  name="logo-twitter"
                  style="font-size: 1.5rem"
                ></ion-icon>
              </a>
              <a
                href="https://www.facebook.com/mvotxcom"
                style="
                  color: #666666;
                  transition: transform 0.3s ease, color 0.2s ease;
                "
                onmouseover="this.style.color='#6420aa'; this.style.transform='scale(1.1)'"
                onmouseout="this.style.color='#666666'; this.style.transform='scale(1)'"
              >
                <ion-icon
                  name="logo-facebook"
                  style="font-size: 1.5rem"
                ></ion-icon>
              </a>
              <a
                href="#"
                style="
                  color: #666666;
                  transition: transform 0.3s ease, color 0.2s ease;
                "
                onmouseover="this.style.color='#6420aa'; this.style.transform='scale(1.1)'"
                onmouseout="this.style.color='#666666'; this.style.transform='scale(1)'"
              >
                <ion-icon
                  name="logo-google"
                  style="font-size: 1.5rem"
                ></ion-icon>
              </a>
              <a
                href="#"
                style="
                  color: #666666;
                  transition: transform 0.3s ease, color 0.2s ease;
                "
                onmouseover="this.style.color='#6420aa'; this.style.transform='scale(1.1)'"
                onmouseout="this.style.color='#666666'; this.style.transform='scale(1)'"
              >
                <ion-icon
                  name="logo-pinterest"
                  style="font-size: 1.5rem"
                ></ion-icon>
              </a>
              <a
                href="#"
                style="
                  color: #666666;
                  transition: transform 0.3s ease, color 0.2s ease;
                "
                onmouseover="this.style.color='#6420aa'; this.style.transform='scale(1.1)'"
                onmouseout="this.style.color='#666666'; this.style.transform='scale(1)'"
              >
                <ion-icon
                  name="logo-linkedin"
                  style="font-size: 1.5rem"
                ></ion-icon>
              </a>
            </div>
            <p
              style="
                font-size: 0.875rem;
                color: #666666;
                animation: fadeInUp 0.8s ease;
              "
            >
              © 2025 — bởi MVOT Group. Mọi quyền được bảo lưu.
            </p>
          </div>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script
      type="module"
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"
    ></script>
    <script>
      const hostList = document.getElementById("host-list");
      const filterGender = document.getElementById("filter-gender");
      const filterDialect = document.getElementById("filter-dialect");
      const filterBirthYearFrom = document.getElementById("filter-birthYear-from");
      const filterBirthYearTo = document.getElementById("filter-birthYear-to");

      let hosts = [];

      // Debounce function to limit frequent calls
      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // Get unique values for filters
      const getUniqueValues = (key) =>
        [...new Set(hosts.map((host) => host[key]))].sort();

      // Initialize filters
      function initializeFilters() {
        const genders = getUniqueValues("gender");
        const dialects = getUniqueValues("dialect");
        const birthYears = getUniqueValues("birthYear").map(Number);

        genders.forEach((gender) => {
          const option = document.createElement("option");
          option.value = gender;
          option.textContent = gender;
          filterGender.appendChild(option);
        });

        dialects.forEach((dialect) => {
          const option = document.createElement("option");
          option.value = dialect;
          option.textContent = dialect;
          filterDialect.appendChild(option);
        });

        const minBirthYear = Math.min(...birthYears);
        const maxBirthYear = Math.max(...birthYears);
        filterBirthYearFrom.value = minBirthYear;
        filterBirthYearTo.value = maxBirthYear;
      }

      // Filter hosts
      function filterHosts() {
        const gender = filterGender.value;
        const dialect = filterDialect.value;
        const birthYearFrom =
          Number(filterBirthYearFrom.value) ||
          Math.min(...hosts.map((h) => Number(h.birthYear)));
        const birthYearTo =
          Number(filterBirthYearTo.value) ||
          Math.max(...hosts.map((h) => Number(h.birthYear)));

        const filteredHosts = hosts.filter((host) => {
          return (
            (!gender || host.gender === gender) &&
            (!dialect || host.dialect === dialect) &&
            Number(host.birthYear) >= birthYearFrom &&
            Number(host.birthYear) <= birthYearTo
          );
        });

        renderHosts(filteredHosts);
      }

      // Render host list with animation
      function renderHosts(hostsToRender) {
        hostList.innerHTML = "";
        if (hostsToRender.length === 0) {
          hostList.innerHTML =
            '<p class="text-gray-500 text-center col-span-full">Không tìm thấy host nào.</p>';
          return;
        }
        hostsToRender.forEach((host, index) => {
          const card = document.createElement("div");
          card.className =
            "host-card bg-white rounded-3xl shadow-xl overflow-hidden p-6 sm:p-8";
          card.innerHTML = `
            <div class="flex flex-col items-center">
              <div class="w-32 h-32 sm:w-40 sm:h-40 rounded-full overflow-hidden border-4 border-white shadow-xl mb-4">
                <img
                  src="${
                    host.personalImages?.[0] || "https://via.placeholder.com/160"
                  }"
                  alt="${host.fullName}"
                  class="w-full h-full object-cover"
                  loading="lazy"
                />
              </div>
              <h3 class="text-lg sm:text-xl font-bold text-gray-900 mb-2">${
                host.fullName
              }</h3>
              <p class="text-sm text-gray-600 text-center mb-4">
                <span class="font-medium"></span> ${host.strengths || "Không có"}
              </p>
              <a
                href="detail.html?id=${host._id}"
                class="btn-primary px-4 sm:px-6 py-2 sm:py-3 rounded-xl flex items-center justify-center text-sm font-semibold"
              >
                <ion-icon name="eye-outline" class="mr-2"></ion-icon>
                Xem chi tiết
              </a>
            </div>
          `;
          hostList.appendChild(card);
          // Trigger animation with slight delay for staggered effect
          setTimeout(() => {
            card.classList.add("visible");
          }, index * 50);
        });
      }

      // Copy link function
      const copyLink = () => {
        const url = window.location.href;
        navigator.clipboard.writeText(url).then(() => {
          alert("Link đã được sao chép vào clipboard!");
        });
      };

      // Debounced filter function
      const debouncedFilterHosts = debounce(filterHosts, 300);

      // Fetch data and initialize
      fetch("https://uploads.mvotx.com/api2/users")
        .then((response) => {
          if (!response.ok) throw new Error("Không thể lấy dữ liệu");
          return response.json();
        })
        .then((data) => {
          hosts = data
            .filter((item) => {
              return item?.personalInfo2?.fullName && item.signStatus != "out";
            })
            .map((item) => {
              return {
                ...item.personalInfo2,
                _id: item._id,
              };
            });
          initializeFilters();
          renderHosts(hosts);
          // Add event listeners for filters
          filterGender.addEventListener("change", debouncedFilterHosts);
          filterDialect.addEventListener("change", debouncedFilterHosts);
          filterBirthYearFrom.addEventListener("input", debouncedFilterHosts);
          filterBirthYearTo.addEventListener("input", debouncedFilterHosts);
        })
        .catch((error) => {
          console.error("Lỗi khi lấy dữ liệu:", error);
          hostList.innerHTML =
            '<p class="text-red-500 text-center col-span-full">Đã xảy ra lỗi khi tải dữ liệu.</p>';
        });
    </script>
  </body>
</html>